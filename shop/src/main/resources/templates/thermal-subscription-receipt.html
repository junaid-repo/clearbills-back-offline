<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title th:text="'Receipt - ' + ${invoiceId}">Receipt</title>
    <style>
        @page {
            size: 80mm;
            margin: 2mm;
        }
        body {
            font-family: 'Monospace', 'Courier New', Courier, monospace;
            font-size: 10px;
            color: #000;
            width: 100%;
            margin: 0;
            padding: 0;
            background: #fff;
        }
        .receipt-container {
            width: 100%;
            box-sizing: border-box;
        }
        .header-main {
            text-align: center;
            border-bottom: 1px dashed #000;
            padding-bottom: 5px;
            margin-bottom: 5px;
        }
        .header-main .shop-name {
            font-size: 16px;
            font-weight: bold;
            margin: 0;
        }
        .header-main p {
            margin: 2px 0;
            font-size: 9px;
            line-height: 1.4;
        }
        .meta-info {
            width: 100%;
            margin: 5px 0;
        }
        .meta-info td {
            font-size: 9px;
            padding: 1px 0;
        }
        .meta-info td:last-child {
            text-align: right;
        }
        .customer-info {
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            padding: 5px 0;
            margin-bottom: 5px;
        }
        .customer-info h4 {
            margin: 0 0 5px 0;
            text-align: center;
            font-size: 11px;
        }
        .customer-info p {
            margin: 2px 0;
            font-size: 10px;
        }
        .items-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 9px;
        }
        .items-table thead th {
            text-align: left;
            padding: 5px 2px;
            border-bottom: 1px solid #000;
            font-size: 10px;
        }
        .items-table tbody td {
            padding: 4px 2px;
            vertical-align: top;
        }
        .items-table .item-name {
            font-weight: bold;
            font-size: 10px;
        }
        .text-right { text-align: right; }
        .totals-summary {
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px dashed #000;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 2px 0;
            font-size: 10px;
        }
        .summary-item.total {
            font-weight: bold;
            font-size: 14px;
            padding-top: 5px;
            border-top: 1px solid #000;
        }
        .amount-in-words {
            margin: 5px 0;
            padding: 5px 0;
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            font-size: 10px;
        }
        .amount-in-words strong {
            display: block;
            margin-bottom: 3px;
        }
        .footer-info {
            margin-top: 10px;
            text-align: center;
            font-size: 9px;
        }
    </style>
</head>

<body>
<div class="receipt-container">

    <!-- a) App name and details at the top -->
    <header class="header-main">
        <h3 class="shop-name" th:text="${appName}">Clear Bill</h3>
        <p th:text="${appAddress}">123 Business Avenue, Ranchi, JH</p>
        <p th:text="'GSTIN: ' + ${appGstin}">GSTIN: 20ABCDE1234F1Z5</p>
        <p th:text="'Phone: ' + ${appPhone}">Phone: +91 98765 43210</p>
    </header>

    <!-- b) Invoice number and then date -->
    <table class="meta-info">
        <tr>
            <td><strong>Invoice:</strong></td>
            <td th:text="${invoiceId}">SUB-001</td>
        </tr>
        <tr>
            <td><strong>Date:</strong></td>
            <td th:text="${invoiceDate}">04-Nov-2025</td>
        </tr>
    </table>

    <!-- c) Combine bill to and ship to -->
    <div class="customer-info">
        <h4>BILL TO</h4>
        <p><strong th:text="${userName}">User Name</strong></p>
        <p th:text="'Ph: ' + ${userPhone}">Ph: 9998887770</p>
        <p th:text="${userAddress}">User Address</p>
        <p th:if="${userGstin != null and !userGstin.isEmpty()}"
           th:text="'GSTIN: ' + ${userGstin}">User GSTIN</p>
    </div>

    <!-- d) Product list with just one row -->
    <table class="items-table">
        <thead>
        <tr>
            <th>Service</th>
            <th class="text-right">Taxable</th>
            <th class="text-right">GST</th>
            <th class="text-right">Total</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>
                <span class="item-name" th:text="${planName}">Premium - Monthly Plan</span>
            </td>
            <td class="text-right" th:text="${#numbers.formatDecimal(taxableAmount, 1, 'COMMA', 2, 'POINT')}">168.64</td>
            <td class="text-right" th:text="${#numbers.formatDecimal(totalGstAmount, 1, 'COMMA', 2, 'POINT')}">30.36</td>
            <td class="text-right" th:text="${#numbers.formatDecimal(totalAmount, 1, 'COMMA', 2, 'POINT')}">199.00</td>
        </tr>
        </tbody>
    </table>

    <!-- e) Total column details -->
    <div class="totals-summary">
        <div class="summary-item">
            <span>Subtotal</span>
            <span th:text="' ' + ${#numbers.formatDecimal(taxableAmount, 1, 'COMMA', 2, 'POINT')}">168.64</span>
        </div>

        <!-- Loop for GST Summary -->
        <div class="summary-item" th:each="entry : ${gstSummary}">
            <span th:text="${entry.key}">CGST @9%</span>
            <span th:text="' ' + ${#numbers.formatDecimal(entry.value, 1, 'COMMA', 2, 'POINT')}">15.18</span>
        </div>

        <div class="summary-item total">
            <span>TOTAL</span>
            <span th:text="' ' + ${#numbers.formatDecimal(totalAmount, 1, 'COMMA', 2, 'POINT')}">199.00</span>
        </div>
    </div>

    <div class="amount-in-words">
        <strong>Amount:</strong>
        <span th:text="${amountInWords}">One Hundred Ninety-Nine Rupees Only</span>
    </div>

    <div class="footer-info">
        <p style="font-weight: bold;">Thank you for your purchase!</p>
        <p th:text="'For support, contact ' + ${appEmail}">For support, contact support@clearbill.com</p>
    </div>

</div>
</body>
</html>